import{_ as m,o as d,c as n,d as t,F as _,f as b,g as u,t as l,b as g,h as x,v as I}from"./index-ac0afc63.js";const{VITE_APP_URL:c,VITE_APP_PATH:r}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_APP_PATH:"hannahtw",BASE_URL:"/week06/dist/",MODE:"production",DEV:!1,PROD:!0},$={data(){return{loadingStatus:{loadingItem:""},products:[],product:{},cart:{}}},methods:{getProducts(){this.$http.get(`${c}/api/${r}/products`).then(s=>{this.products=s.data.products}).catch(s=>{alert(s.response.data.message)})},getProduct(s){this.loadingStatus.loadingItem=s,this.$http.get(`${c}/api/${r}/product/${s}`).then(a=>{this.loadingStatus.loadingItem="",this.product=a.data.product,this.$refs.userProductModal.openModal()}).catch(a=>{alert(a.res.data.message)})},updateCart(s){this.loadingStatus.loadingItem=s.id;const a={product_id:s.product_id,qty:s.qty};this.$http.put(`${c}/api/${r}/cart/${s.id}`,{data:a}).then(i=>{alert(i.data.message),this.loadingStatus.loadingItem="",this.getCart()}).catch(i=>{alert(i.res.data.message),this.loadingStatus.loadingItem=""})},deleteAllCarts(){this.$http.delete(`${c}/api/${r}/carts`).then(s=>{alert(s.data.message),this.getCart()}).catch(s=>{alert(s.response.data.message)})},getCart(){this.$http.get(`${c}/api/${r}/cart`).then(s=>{this.cart=s.data.data}).catch(s=>{alert(s.res.data.message)})},removeCartItem(s){this.loadingStatus.loadingItem=s,this.$http.delete(`${c}/api/${r}/cart/${s}`).then(a=>{alert(a.data.message),this.loadingStatus.loadingItem="",this.getCart()}).catch(a=>{alert(a.res.data.message)})}},mounted(){this.getProducts(),this.getCart()}},f=t("h3",null,"這是購物車頁面",-1),v={class:"table align-middle"},y=t("thead",null,[t("tr",null,[t("th"),t("th",null,"品名"),t("th",{style:{width:"150px"}},"數量/單位"),t("th",null,"單價"),t("th",null,"小計")])],-1),P=["onClick","disabled"],C={key:0,class:"fas fa-spinner fa-pulse"},S={key:0,class:"text-success"},V={class:"input-group input-group-sm"},k={class:"input-group mb-3"},A=["onUpdate:modelValue","onBlur","disabled"],E={class:"input-group-text",id:"basic-addon2"},T={class:"mb-3"},B={class:"mb-3"},q={class:"text-success"},w=t("td",{colspan:"4",class:"text-end"},"總計",-1),D={class:"text-end text-danger"},U={key:0},L=t("td",{colspan:"4",class:"text-end text-success"},"折扣價",-1),M={class:"text-end text-success"};function R(s,a,i,N,o,p){return d(),n(_,null,[f,t("table",v,[y,t("tbody",null,[o.cart.carts?(d(!0),n(_,{key:0},b(o.cart.carts,e=>(d(),n("tr",{key:e.id},[t("td",null,[t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:h=>p.removeCartItem(e.id),disabled:o.loadingStatus.loadingItem===e.id},[o.loadingStatus.loadingItem===e.id?(d(),n("i",C)):u("",!0),g(" x ")],8,P)]),t("td",null,[g(l(e.product.title)+" ",1),e.coupon?(d(),n("div",S," 已套用優惠券 ")):u("",!0)]),t("td",null,[t("div",V,[t("div",k,[x(t("input",{"onUpdate:modelValue":h=>e.qty=h,onBlur:h=>p.updateCart(e),disabled:o.loadingStatus.loadingItem===e.id,min:"1",type:"number",class:"form-control"},null,40,A),[[I,e.qty,void 0,{number:!0}]]),t("span",E,l(e.product.unit),1)])])]),t("td",null,[t("div",null,[t("div",T,[t("span",null,l(e.product.price),1)])])]),t("td",null,[t("div",B,[t("span",q,l(e.product.price*e.qty),1)])])]))),128)):u("",!0)]),t("tfoot",null,[t("tr",null,[w,t("td",D,l(o.cart.total),1)]),o.cart.final_total!==o.cart.total?(d(),n("tr",U,[L,t("td",M,l(o.cart.final_total),1)])):u("",!0)])])],64)}const H=m($,[["render",R]]);export{H as default};
